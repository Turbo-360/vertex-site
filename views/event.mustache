<!DOCTYPE html>
<head>
  {{>head}}
  <meta property="og:title" content="Meetup | {{event.name}}" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="https://www.vertex360.co/event/{{event.slug}}" />
	<meta property="og:image" content="{{{event.image}}}=s512" />
	<meta property="og:image:width" content="260px" />
	<meta property="og:image:height" content="260px" />
	<meta property="og:description" content="{{event.preview}}" />

  <style>
    .template-details {
      text-align: right
    }

    .template-details img {
      width: 32px;
      border-radius: 50%;
      margin-left: 4px;
    }

    .btn-edit {
      text-transform: uppercase;
      font-size: 9.7px;
      letter-spacing: 2.5px;
      font-weight: 60;
      background: #f91942;
      border-radius: 24px;
      padding: 8px 12px;
      line-height: 20px;
      color: #fff !important;
      font-weight: 400;
      margin-bottom: 9px;
    }

    @media (min-width: 768px) {
      .post-container {
        padding-top: 120px
      }

      .lg-pt-40 {
        padding-top: 40px;
      }
    }

    @media (max-width: 768px) {
      .post-content {
        padding: 16px !important;
      }
    }

    #launch-template-container a {
      width: 100%;
      padding: 20px;
      text-align: center;
      font-size: 20px;
      border-radius: 6px;
      color: #fff;
    }

    .details {
      color: red;
      font-weight: 600;
      font-size: 20px;
    }

    .post-content p {
      margin-top: 0px;
      margin-bottom: 0px;
    }

    .post-content ul {
      margin-top: 30px;
      margin-bottom: 30px;
    }
  </style>
</head>

<body>
  <div id="wrapper" style="background:#f9f9f9">
    {{>nav}}
    <div class="clearfix"></div>
    <div class="container lg-pt-40">
      <div class="row post-container">
    		<div class="col-lg-9 col-md-8 padding-right-30">
    			<div class="blog-post single-post">

    				<div class="post-content">
              <h1 style="font-size:32px">{{event.name}}</h1>
              <ul class="post-meta margin-top-0 margin-bottom-0">
    						<li style="text-transform:uppercase">{{event.dateString}}</li>
    					</ul>
              <hr class="margin-top-20 margin-bottom-30" />
              <img class="post-img margin-bottom-30" src="{{{event.image}}}=s1024" alt="Vertex 360 | {{template.name}}">
    					{{{event.description}}}
    				</div>

            <!-- About Author -->
      			<div id="launch-template-container" class="about-author" style="margin:0px;border-top:1px solid #ededed;border-bottom:1px solid #ededed;background:#fffffa">
      				<div style="min-height:120px">
                <h2 class="margin-bottom-20 margin-top-0">RSVP</h2>
                <p>
                  <strong class="details">{{event.dateString}}</strong><br />
                  <strong class="details">{{event.location.venue}}</strong><br />
                  <strong class="details">{{event.location.address}}</strong><br />
                  <strong class="details">{{event.location.city}}, {{event.location.state}}</strong>
                </p>
      					<p>To attend this event, complete the form below:</p>

                <form method="post" class="login margin-top-40">
                  <div class="input-row">
                    <div class="input-label">Name</div>
                    <div class="input-container">
                      <input id="input-rsvp-name" type="text">
                    </div>
                  </div>

                  <div class="input-row">
                    <div class="input-label">Email</div>
                    <div class="input-container">
                      <input id="input-rsvp-email" type="text">
                    </div>
                  </div>
                </form>
      				</div>

              <hr />
              <a id="btn-attend-event" href="#" class="button with-icon">Attend This Event <i class="sl sl-icon-login"></i></a>
      			</div>
    			</div>

          <!-- Related Posts -->
    			<div class="clearfix"></div>
          <hr />
    			<h3 class="headline margin-top-25 margin-bottom-10">Launch Your Website</h3>
          <p>
            Get up and running with a gorgeous new website in under an hour. Our
            easy website builder enables anyone to create beautiful, professional
            websites without endlessly tinkering with confusing tools, drag & drop
            interfaces or code.
          </p>
    			<div id="featured-templates" class="row"></div>
    			<div class="margin-top-50"></div>
    	  </div>

      	<!-- Widgets -->
        <div class="col-lg-3 col-md-4">
      		<div class="sidebar right">
      			<div class="widget margin-top-20">
      				<h3>Featured Templates</h3>
      				<ul id="related-sites" class="widget-tabs"></ul>
      			</div>
      		</div>
      	</div>
    	</div>
    	<!-- Sidebar / End -->

    </div>

    {{>footer-dark}}
    <a style="display:none" id="btn-show-modal" href="#sign-in-dialog" class="popup-with-zoom-anim">test</a>
  </div>
  <!-- Wrapper / End -->


  <script type="text/template" id="tpl-site-preview">
    <div class="col-lg-6 col-md-6">
      <a href="/template/<% slug %>" class="listing-item-container compact">
        <div class="listing-item">
          <img src="<%{image}%>=s1024-c" alt="Vertex 360">
          <div class="listing-item-content">
            <h3 style="line-height:22px;text-transform:capitalize"><% name %></h3>
            <small style="color:#999;font-size:16px"><% template.category %></small>
          </div>
        </div>
      </a>
    </div>
  </script>

  <script type="text/template" id="tpl-site-sidebar">
    <li>
    	<div class="widget-content">
    		<div class="widget-thumb">
    			<a href="/template/<% slug %>">
            <img src="<%{image}%>=s120-c" alt="Vertex 360 | <% name %>" />
          </a>
    		</div>

        <div class="widget-text" style="padding-top:6px">
          <h5 class="preview-title">
            <a href="/post/<% slug %>"><% name %></a>
          </h5>
    			<small><% template.category %></small>
    		</div>
    		<div class="clearfix"></div>
    	</div>
    </li>
  </script>

  <script type="text/javascript">window.__PRELOADED__ = {{{preloaded}}}</script>
  <script type="text/javascript" src="{{{cdn}}}/dist/js/vendor.min.js"></script>
  <script>
    (function(){
      Mustache.tags = ["<%", "%>"] // change delimiter so it doesn't conflict server side
      var data = window.__PRELOADED__
      var getRequest = function(url, completion){
        $.ajax({
          url: url,
          type: 'GET',
          data: null,
          success: function(response){
            completion(null, response)
          },
          error: function(response){
            completion(response, null)
          }
        })
      }

      var postRequest = function(url, params, completion){
        $.ajax({
          url: url,
          type: 'POST',
          data: params,
          success: function(response){
            completion(null, response)
          },
          error: function(response){
            completion(response, null)
          }
        })
      }

      getRequest('/api/site?template.status=live&format=vertex', function(err, response){
        if (response.confirmation != 'success'){
          return
        }

        // console.log('SITES: ' + JSON.stringify(response))
        var sites = response.results
        var tpl = $('#tpl-site-preview').html()
        var tplSidebar = $('#tpl-site-sidebar').html()

        var sitesHtml = ''
        var sidebarHtml = ''
        sites.forEach(function(site, i){
          sidebarHtml += Mustache.render(tplSidebar, site)
          if (i<4)
            sitesHtml += Mustache.render(tpl, site)
        })

        $('#featured-templates').html(sitesHtml)
        $('#related-sites').html(sidebarHtml)
      })

      $('#btn-attend-event').click(function(event){
        if (event)
          event.preventDefault()

        var attendee = {
          name: $('#input-rsvp-name').val(),
          email: $('#input-rsvp-email').val()
        }

        if (attendee.name.length==0){
          alert('Please enter your NAME')
          return
        }

        if (attendee.email.length==0){
          alert('Please enter your EMAIL')
          return
        }

        attendee['event'] = JSON.stringify({
          id: data.event.id,
          name: data.event.name,
          slug: data.event.slug,
          image: data.event.image,
          location: data.event.location
        })

        // create attendee object or add to list in Event in DB
        postRequest('/account/rsvp', attendee, function(err, response){
          console.log('CONFIRMATION: ' + JSON.stringify(response))
          alert('Thanks! Check your email for confirmation.')
          window.location.href = '/'
        })
      })

      $('#btn-newsletter-subscribe').click(function(event){
        if (event)
          event.preventDefault()

        var subscriber = {
  //        name: $('#input-newsletter-name').val(),
          email: $('#input-newsletter-email').val()
        }

        if (subscriber.email.length == 0){
          alert('Please enter your EMAIL')
          return
        }

        $.ajax({
          url: '/account/mailchimp',
          type: 'POST',
          data: subscriber,
          success: function(response){
            if (response.confirmation != 'success'){
              alert('Error - '+response.message)
              return
            }

            alert('Thanks For Subscribing!')
          },
          error: function(err){
            alert('Error - ' + err)
          }
        })
      })

    })()
  </script>

  {{#cdn}}{{>analytics}}{{/cdn}}
</body>
</html>
